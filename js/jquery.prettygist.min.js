/*
 * pretty-gist
 * http://www.joepettersson.com/pretty-gist/
 *
 * Copyright (c) 2012 Joe Pettersson
 * Licensed under the MIT, GPL licenses.
 */(function(e,t,n,r){"use strict";function o(t,n){this.element=t,this.options=e.extend({},s,n),this.init()}var i="prettyGist",s={showHeader:!0,extendedHeader:!0,showFooter:!0};o.prototype={init:function(){var t=e(this.element).attr("id").substring(5),n=this.options,r=this.element,i=this.placeholder(r,t),s=this.model(t,function(i){e("#placeholder-for-"+t).replaceWith(o.prototype.layout(i,r,n)),n.showFooter===!0&&o.prototype.bind(i.data.id),typeof hljs!="undefined"&&(hljs.initHighlightingOnLoad(),e(".pretty-gist").addClass("hljs"))})},placeholder:function(t,n){var r='<div class="pretty-gist-placeholder" id="placeholder-for-'+n+'"></div>';e(r).insertAfter(t)},model:function(t,n){e.getJSON("https://api.github.com/gists/"+t+"?callback=?",function(e){n(e)})},layout:function(t,n,r){var i="";return i+='<div class="pretty-gist" id="pretty-gist-'+t.data.id+'">',r.showHeader===!0&&(i+='<div class="header clear">',r.extendedHeader===!0?(i+='<div class="logo"><a href="https://github.com/">Github</a></div>',i+='<div class="user"><a href="https://github.com/'+t.data.user.login+'" class="github-user">',typeof t.data.user.avatar_url!="undefined"&&t.data.user.avatar_url.length>0?i+='<img src="'+t.data.user.avatar_url+'" alt="Avatar" width="34px" height="34px" />':i+='<img src="https://a248.e.akamai.net/assets.github.com/images/gravatars/gravatar-140.png" alt="Avatar" width="34px" height="34px" />',i+="</div>",i+='<div class="github-user-data">',i+='<h2><a href="https://gist.github.com/gists/'+t.data.id+'">'+t.data.description+"</a></h2>",i+='<h3><a href="https://github.com/'+t.data.user.login+'">'+t.data.user.login+"</a></h3>",i+="</div>"):i+='<h2 class="single"><a href="https://gist.github.com/gists/'+t.data.id+'">'+t.data.description+"</a></h2>",i+="</div>"),i+='<div class="code-container"><ol>',e.each(e(n).find(".line"),function(t){i+='<li class="pretty-line" id="pretty-line-'+t+'"><pre><code>'+e(this).html()+"</pre></code></li>"}),i+="</ol></div>",r.showFooter===!0&&(i+='<div class="footer clear">',i+='<a href="https://gist.github.com/gists/'+t.data.id+'/download" class="button left">Download Gist</a>',i+='<a href="#" class="button middle show-embed" data-embed="https://gist.github.com/'+t.data.id+'.js">Embed Gist</a>',i+='<a href="#" class="button right show-clone-url" data-clone-url="git://gist.github.com/'+t.data.id+'.git">Clone Gist</a>',i+='<a href="#" class="button single show-plugin-info">Info</a>',i+="</div>"),i+="</div>",i},bind:function(t){e("#pretty-gist-"+t+" .show-embed").click(function(n){n.preventDefault();var r="&lt;script src=&quot;"+e(this).attr("data-embed")+"&quot;>&lt;/script>",i="Embed code:";o.prototype.modal(t,i,r)}),e("#pretty-gist-"+t+" .show-clone-url").click(function(n){n.preventDefault();var r=e(this).attr("data-clone-url"),i="Clone url:";o.prototype.modal(t,i,r)}),e("#pretty-gist-"+t+" .show-plugin-info").click(function(e){e.preventDefault();var n='Pretty Gist by <a href="http://www.joepettersson.com/pretty-gist/">Joe Pettersson</a><br />A plugin to make prettier and more functional embedded Github Gists';o.prototype.modal(t,n)})},modal:function(t,n,r){e("#pretty-gist-"+t).find(".gist-modal").remove();var i="",s=e("#pretty-gist-"+t).outerWidth()-2,o=e("#pretty-gist-"+t+" .code-container").outerHeight()/2-23;i+='<div class="gist-modal" style="width: '+s+"px; padding: "+o+'px 0px;">',i+="<p>"+n+"</p>",typeof r!="undefined"&&(i+='<input type="text" value="'+r+'" class="gist-input" name="embed-url" />'),i+="</div>",e(i).insertBefore("#pretty-gist-"+t+" .code-container"),e("#pretty-gist-"+t+" .gist-modal").click(function(n){e("#pretty-gist-"+t).find(".gist-modal").remove()})}},e.fn[i]=function(t){return this.each(function(){e.data(this,"plugin_"+i)||e.data(this,"plugin_"+i,new o(this,t))})}})(jQuery,window,document);